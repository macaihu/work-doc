# 变电站计算机管理软件的开发



![](http://oyuejdk7j.bkt.clouddn.com/bdzgl_pic1.png)


南昌供电局生技科
一九九八年十二月      

## 问题的提出：

变电站是供电行业的重要的生产部门，肩负着设备正常运行，事故处理、缺陷检查等重要职责。现在，大多数变电站的管理方式仍停留在手工抄写、整理的阶段上。工作量繁杂，整理时间长，容易造成台帐、资料不能及时反映现场情况、效率低下，给安全生产带来了隐患。

1997年，南昌供电局给所属220KV变电站配备了计算机。配备之后，各站都在尽力发挥其作用，盘龙山和斗门都自行开发了人事管理的程序，昌东站将所有报表输入了计算机中。1997年底，在生技科的协助下，所有配备计算机的变电站都实现了电量计算的自动化。但是，在没有专业的配套软件之前，各站只能进行简单的文档操作和简单的数据库处理，无法完成管理的重任，未能充分发挥计算机的作用，尚未完全达到本局为变电站配备计算机的初衷：提高变电站运行管理的技术水平。因此，研制开发一套变电站计算机管理软件不仅是必要的，而且是可行的。

本软件是生技科根据南昌供电局变电站计算机应用情况，结合本局技术力量，为提高本局变电站技术管理水平，于1997年提出了220KV变电站计算机管理系统开发技术方案的初稿。于1997年10月组织人员开始开发。主要目标是：开发出一套集设备管理、运行管理、操作管理的变电站管理软件。


参与开发人员和开发时间表


参与人员：

姓名	|在本次开发中的作用
-----|------
张筱玲	|总体设计者和开发领导者
漆通生	|具体生产技术指导者
万云瑞	|常见缺陷的归纳总结
秦文洪	|常见缺陷的归纳总结、输入
简亮	|软件编程开发者

开发时间表:

时间	| 任务
-----|------
1997年10月	|问题的提出及可行性分析
1997年11月~1997年12月|	需求分析
1997年12月~1998年1月|	数据库结构确定、平台和开发工具的选择
1998年1月~1998年3月	|首期部分功能的开发
1998年3月	| 在盘龙山试运行
1998年3月~1998年6月	|全部功能的开发
1998年6月~1998年7月	|安装调试






# 开发的过程

![](http://oyuejdk7j.bkt.clouddn.com/bdzgl_pic2.png)

## 准备阶段：

这一阶段的主要任务是确定软件的使用范围，主要功能。其主要依据是”变电站计算机管理系统”的设计方案初稿。完成的主要工作有：
1. 变电站管理的需求分析(附录1)，这是在220KV变电站计算机管理软件功能的初稿的基础上，听取了变电站运行人员、分局管理人员的意见和要求编写的，是本次软件开发的目标和功能约束。
2. 系统的编码体系(附录2)，这是在总结了过去的几种编码体系的的优缺点的基础上，结合南昌供电局的实际情况提出的。
3. 变电站常见缺陷的总结，这是提高输入效率，规范称谓的重点。现已分类输入计算机中。
4. 资料的收集和整理。
5. 定义数据库结构，这是在资料的收集和整理之后，将需要处理的资料转换成计算机能够处理的形式。这是准备阶段的最为重要的工作之一。本次开发是参考了大量的其他软件的数据库结构，根据南昌供电局的实际情况来定义的。

## 系统的的平台和开发工具

由于WINDOWS操作系统的普及和可视化开发的工具的广泛运用，根据变电站计算机的配置，本次开发是使用的平台是WINDOWS 3.2中文版，主要优点是WINDOWS3。2中文版提供了中文窗口环境，菜单驱动，鼠标操作。操作简单直观，使操作人员摆脱了DOS下令人费解的命令行方式。

开发工具选择的是BORLAND公司的可视化编程工具DELPHI 1.0。于同类产品相比较，其优点是开发速度快，运行稳定可靠。提供了完整的数据库支持。值得一提的是，在INTERNET网上有几千个DELPHI的控件可供下载使用，在功能上几乎是应有尽有，这一点极大的扩展了DELPHI的功能，弥补了其不足。


## 代码的编制：

代码的编制是编制软件最重要的部分之一，是决定一个软件得最为重要的部分。
在本次开发中使用了以下新技术：
1. 面向对象技术。面向对象技术是软件工程发展的趋势，其特点是：是编制代码和人的思维结合，是结构化编程的一次重大的飞跃。使用面向对象技术，能有效的缩短代码的编制难度，特别是对超过万行软件的编制。（本软件共有13000行代码）。DELPHI是完全的面向对象的编程工具。
2. 可视化编程技术。在MICROSOFT推出WINDOWS操作系统之后，几乎所有的PC软件都转向了WINDOWS平台。针对WINDOWS应用程序开发难度远高于DOS的情况，MICROSOFT提出了可视化编程技术，并首先在VB中使用，很快得到了广泛的认可。DELPHI是一款优秀的可视化编程工具。由于可视化编程技术采用了DRAG & DROP技术，使得WINDOWS应用程序开发变得更快了。
3. 快速高效通用的数据库引擎。DELPHI使用了BORLAND公司的BDE数据库引擎，和MICROSOFT的ODBC相比较，更加快速高效。由于采用了数据别名技术，使得更换数据库可以不更改代码（数据库格式需相同）。
4. 本次开发充分利用了INTERNET的强大功能。首先：界面设计中使用了从INTERNET上下载的控件：TSPLITTE，TDANHINT，TBTNBOTTON。使得界面更加容易使用。其次，许多编制代码过程中遇到的疑难问题都在INTERNET的BBS中得到了来自五湖四海的技术人员的无私帮助，极大的加快了进度。



完成情况：

标题1 | 标题2
---|---
工程文件|	2个
 -|	系统工程文件
 -|	典型缺陷分类输入工程文件
代码	|15000行
模块|	49个
数据库表格	|67个
窗口定义	|43个
外加免费控件	|3个
管理的设备	|15种
编制系统总文件	|754个

除了完成基本的注册、修改、增加、删除、统计、打印等功能外，此软件还完成了许多自动完成的功能，以期望真正能减轻运行人员负担，提高劳动生产效率。主要表现在：
1. 设备情况（异动、检修等）自动入台帐，无须手工整理；
如果是手工抄写，必须在日常纪录的同时，将设备缺陷、设备定级、继电保护及自动装置试验纪录、设备检修纪录这些在日常纪录中以及记录了一遍的的资料在此抄写到设备台帐中。这是一件繁琐而工作。本软件能自动将日常纪录中的纪录按照设备单元名分类进入设备台帐。

2. 自动根据设备缺陷完成设备定级工作；
设备定级是根据设备缺陷和设备消缺情况对设备进行评价的一种操作。如果是手工抄写，必须完全了解变电站的设备的情况，难免挂一漏万。而且，工作周期长。使用本软件提供的自动设备定级功能，只需要点击几下鼠标，系统将根据计算机内的设备缺陷和设备消缺情况，可以自动、迅速、方便、准确的进行设备定级。

3. 自动根据调度命令生成保护投退报表；
4. 自动根据调度命令生成变电设备运行情况统计表；
保护投退报表和变电设备运行情况统计表是变电站需要上报的报表。需要查阅大量的有关纪录，特别是调度命令纪录，工作量繁杂。本软件在根据运行的实际特点，在输入调度命令的同时就自动生成了相应的保护投退报表和变电设备运行情况统计表中的纪录。以期提高工作效率。

5. 自动生成调度命令记录；
调度命令是变电站的重要纪录，保护投退报表和变电设备运行情况统计表都是主要根据调度命令生成的。本软件专门为调度命令设计了调度命令生成器，一方面是方便输入，把繁琐的输入变成简单的鼠标操作。另一方面是生成保护投退报表和变电设备运行情况统计表。

6. 自动判断安全工具检验日期是否过期；
安全工具变电站操作的重要工具，保证安全工具的可靠性是维护运行人员的人身安全和设备安全的重要环节。及时检查安全工具的安全期限才能保证安全工具安全。本软件自动根据安检周期和上一次安检日期判断每一个安全工具是否超过了安检周期，并给出提示。

7. 自动判断工作票是否过期未终结；
工作票的许可制度是保证检修、试验工作人员人身安全，设备安全运行的重要保证。工作票的许可、总结都有严格的制度。工作票过期为终结是安全生产的隐患。本软件自动根据工作票的有效期和当前日期判断工作票是否过期未终结。

8. 极大减少运行人员的输入工作表现在：
①	常见缺陷已由生技科用大量时间、精力整理、输入完毕，运行人员只须点取；
②	所有台帐中的信息直接从库中读取，只须在建台帐时输入，日常工作时只须点取；
③	其他信息(如工作班班长名、厂家厂名等) 只须输入一次即自动记忆，以后只须点取。


## 软件的使用情况：

本软件1998年6月已在斗门、盘龙山、昌东投入使用，运行稳定，情况良好。通过软件的试运行，一方面可以规范220KV变电站的运行管理，另一方面可以锻炼运行人员的计算机使用水平。本软件还可以作为变电站管理子系统接入据MIS系统。
