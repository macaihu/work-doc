# 程序设计说明书接线图

如何实现接线图是本系统的关键所在，应充分发挥接线图的作用，与设备相关的操作均应在接线图中完成。由于有分局端，设计时应增加变电站代码。

## 一、接线图的绘制
接线图以数据库形式保存。按其中图形类型可分为四种：
* A、设备图形：如主变、断路器等，其特点是大小固定，图形有固定标准；
* B、文字信息：如各线路的名称、开关的编号等等；
* C、连线：连线只是连线，是站内设备连接的导线，在接线图中只是表示两设备的连
* D、连线设备：包括母线、线路和电缆，它们和连线类似，在接线图中长度可变，但和连线不同的是它们是设备。  
这四种图形分别以四个表格来存储：（所有字段均无小数位）

#### A、设备图形：
字段     |     类型    |      宽度    |      索引
--       |     --    |      --      |      --
设备代码  |       C    |        6    |          *
LEFT     |       N    |        4    |
TOP      |       N    |        4    |
图形文件名 |       C   |        254   |

设备图形在窗口中以TImage来显示，其LEFT和TOP分别记录了设备在窗口中的位置。图形文件名记录了使用了什么图形，可用TImage.Picture.LoadFromFile方法，设备图形的大小可由Picture的大小而定。TImage.Tag记录了其设备编号。由于Tag只处理整型，而设备代码可能性包括字母，应进行相应地处理。（可以增加一字符串数组以位置作为Tag的值，而将设备代码写入此字符串数组访问时即可能通过Tag值得到其设备代码）。

#### B、文字信息：
字段      |     类型    |      宽度    |      索引
--        |     --    |      --      |      --
文字      |     C      |    254       |
LEFT     |       N    |       4      |
TOP      |       N    |       4      |
字体名    |    C       |   20         |
是否加粗  | BOOLEAN    |    1          |
是否倾斜  | BOOLEAN    |    1          |
是否下划线 | BOOLEAN   |    1          |
字体大小   |   N       |    3          |
颜色      |     C      |   10         |
横向      |     C      |   10         |
ID       |       N    |     3         |
文字信息在窗口中可用TLabel来显示。文字记录了需显示的内容，LEFT、TOP同设备图形，其余为字体信息。ID值可赋于Tag，以便于访问。

#### C、连线

字段      |     类型   |     宽度      |      索引
--       |     --     |      --      |      --
LEFT     |   N        |   4          |                       
TOP      |   N        |   4          |
REGHT    |   N        |   4          |
BOTTOM   |   N        |   4          |
WIDTH    |   N        |   1          |
ID       |   N        |   3          |
连线在窗口中可用TSHAPE来显示，四个字段分别代表了连线头和尾的坐标值。WIDTH为宽度。

#### D、连线设备

字段      |     类型   |     宽度      |      索引
--       |     --     |      --      |      --
设备代码  |      C     |      6       |      *

其余同连线，无ID字段。

当需要在窗口中显示接线图时，似次访问这四个表格中，每读一条记录，将相应的控制CREATE出一个新的，显示出相应图形。

## 二、设备台账的访问
对于设备图形和连线设备而言，当鼠标停留在其图形上时，应变成手状，表示可以单击以访问设备台账。
