
#### 2019.06.15
**李柱栋**  整个声音框架流程是： 用户程序通过操作 /dev/snd和 /proc/asound/ 下的设备播放声音，驱动程序产生上述设备和相关控制流程，把应用层的数据通过PCM设备使用GDMA的tx、rx通道对外通讯，gdma收发有对应全局中断GIC来调度。
<hide>
目前已完成的工作是：

1. 用户应用层移植了alsa-lib、alsa-utils，可以直接使用编译出来的录音程序arecord、播放程序aplay处理wav文件，方便调试使用。
2. 内核alsa-soc框架已配置成功，对应的pcm、gdma驱动由网上一份RT5350和mt7620的pcm驱动移植过来，已经可以产生 /dev/snd和 /proc/asound/ 下相关设备接口。从寄存器上看，mt7621和mt7620的pcm寄存器是完全一样的，gdma部分也基本一样，但是gdma使用的中断部分不一样。看mt7620是使用INTCTL(0x1E000200)，而mt7621的中断系统有INTCTL(0x1E000200)，但是默认使用GIC(0x1FBC0000)，目前没有GIC(0x1FBC0000)的相关资料，从代码看mt7621的GIC和INTCTL是否能兼容、相互之间怎么转换还不清楚。
3. linux内核版本3开始使用设备树dts文件来组织驱动：
（1）完成mt7621的PCM对应端口的复用代码和文件描述，从log上应该配置成功，需要验证是否真正有效。
（2）gdma配置可以产生gdma设备，但是对channel使用还不是非常了解，不明白为什么原mt7620使用了两个RDMA作为tx、rx，而不是分别使用一个TDMA和一个RDMA来作为tx、rx。
（3）pcm和gdma对应的中断都由INTCTL改为GIC方式，暂时还不能验证是否配置有效。
（4）sound对应的codec和machine配置完成，可以通过cpu-dai、codec-dai关联pcm、codec接口，产生 /dev/snd和 /proc/asound/ 下声卡播放、录音、控制接口，目前还没了解codec对pcm的使用，原接口这部分一般是对应I2S的。
总的来说框架和测试手段都完成了，后续可以深入细节部分的调整。
</hide>
#### 2019.06.12
吕强 我们主要对接的是原厂的wifi部门，之前有问过原厂fae，对于pcm原厂是没有支持的
**李柱栋**  文档dma和加密引擎的，没有中断的内容
#### 2019.5.16
**李柱栋** pcm需要绑定dma，现在dma可以编译进去，pcm的驱动也能编译过去。
#### 2019.5.10
**李柱栋** 发出对pcm和gdma的疑问邮件。
**吕强** 我们没有试过，没有这个数据，原厂说的是这些都是标准通用的接口。
#### 2019.4.28
**徐刚雄** 设备的slic线断了，没有其他好板子了。
#### 2019.4.26
**蔡松延** 把李柱栋的patch加上，发送数据看起来是正常的，片选也貌似正常，但回应感觉不对，示波器量着也不对。从示波器量的情况来看，发送的数据是对的，但是回来的数据和时钟一样的波形，幅度不到1v，所以从逻辑分析器上看就是直线。  
**徐钢雄** 在看这个问题。
